<html><head><title>scalismo: Rigid alignment</title><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="University of Basel" /><meta name="description" content="Scalismo - Scalable Image Analysis and Shape Modelling " /><meta name="og:image" content="/scalismo.github.io/img/poster.png" /><meta name="image" property="og:image" content="/scalismo.github.io/img/poster.png" /><meta name="og:title" content="scalismo: Rigid alignment" /><meta name="title" property="og:title" content="scalismo: Rigid alignment" /><meta name="og:site_name" content="scalismo" /><meta name="og:url" content="" /><meta name="og:type" content="website" /><meta name="og:description" content="Scalismo - Scalable Image Analysis and Shape Modelling " /><link rel="icon" type="image/png" href="/scalismo.github.io/img/favicon.png" /><meta name="twitter:title" content="scalismo: Rigid alignment" /><meta name="twitter:image" content="/scalismo.github.io/img/poster.png" /><meta name="twitter:description" content="Scalismo - Scalable Image Analysis and Shape Modelling " /><meta name="twitter:card" content="summary_large_image" /><link rel="icon" type="image/png" sizes="16x16" href="/scalismo.github.io/img/favicon16x16.png" /><link rel="icon" type="image/png" sizes="24x24" href="/scalismo.github.io/img/favicon24x24.png" /><link rel="icon" type="image/png" sizes="32x32" href="/scalismo.github.io/img/favicon32x32.png" /><link rel="icon" type="image/png" sizes="48x48" href="/scalismo.github.io/img/favicon48x48.png" /><link rel="icon" type="image/png" sizes="57x57" href="/scalismo.github.io/img/favicon57x57.png" /><link rel="icon" type="image/png" sizes="60x60" href="/scalismo.github.io/img/favicon60x60.png" /><link rel="icon" type="image/png" sizes="64x64" href="/scalismo.github.io/img/favicon64x64.png" /><link rel="icon" type="image/png" sizes="70x70" href="/scalismo.github.io/img/favicon70x70.png" /><link rel="icon" type="image/png" sizes="72x72" href="/scalismo.github.io/img/favicon72x72.png" /><link rel="icon" type="image/png" sizes="76x76" href="/scalismo.github.io/img/favicon76x76.png" /><link rel="icon" type="image/png" sizes="96x96" href="/scalismo.github.io/img/favicon96x96.png" /><link rel="icon" type="image/png" sizes="114x114" href="/scalismo.github.io/img/favicon114x114.png" /><link rel="icon" type="image/png" sizes="120x120" href="/scalismo.github.io/img/favicon120x120.png" /><link rel="icon" type="image/png" sizes="128x128" href="/scalismo.github.io/img/favicon128x128.png" /><link rel="icon" type="image/png" sizes="144x144" href="/scalismo.github.io/img/favicon144x144.png" /><link rel="icon" type="image/png" sizes="150x150" href="/scalismo.github.io/img/favicon150x150.png" /><link rel="icon" type="image/png" sizes="152x152" href="/scalismo.github.io/img/favicon152x152.png" /><link rel="icon" type="image/png" sizes="196x196" href="/scalismo.github.io/img/favicon196x196.png" /><link rel="icon" type="image/png" sizes="310x310" href="/scalismo.github.io/img/favicon310x310.png" /><link rel="icon" type="image/png" sizes="310x150" href="/scalismo.github.io/img/favicon310x150.png" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" /><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" /><link rel="stylesheet" href="/scalismo.github.io/highlight/styles/default.css" /><link rel="stylesheet" href="/scalismo.github.io/css/style.css" /><link rel="stylesheet" href="/scalismo.github.io/css/palette.css" /><link rel="stylesheet" href="/scalismo.github.io/css/codemirror.css" /></head><body class="docs"><div id="wrapper"><div id="sidebar-wrapper"><ul id="sidebar" class="sidebar-nav"><li class="sidebar-brand"><a href="/scalismo.github.io/" class="brand"><div class="brand-wrapper"><span>scalismo</span></div></a></li> <li><a href="/scalismo.github.io/tutorials/tutorial1.html" class="">Hello Scalismo</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial2.html" class=" active ">Rigid alignment</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial3.html" class="">From meshes to deformation fields</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial4.html" class="">Gaussian processes and Point Distribution Models</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial5.html" class="">Gaussian processes, sampling and marginalization</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial6.html" class="">Building a shape model from data</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial7.html" class="">Gaussian processes and kernels</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial8.html" class="">Posterior Shape Models</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial9.html" class="">Shape completion</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial10.html" class="">ICP for rigid alignment</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial11.html" class="">Model fitting with ICP</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial12.html" class="">Parametric, non-rigid registration</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial13.html" class="">Active Shape Models</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial14.html" class="">Model fitting using MCMC - The basic framework</a></li> <li><a href="/scalismo.github.io/tutorials/tutorial14.html" class="">Model fitting using MCMC - Fitting a shape model</a></li></ul></div><div id="page-content-wrapper"><div class="nav"><div class="container-fluid"><div class="row"><div class="col-lg-12"><div class="action-menu pull-left clearfix"><a href="#menu-toggle" id="menu-toggle"><i class="fa fa-bars" aria-hidden="true"></i></a></div><ul class="pull-right"><li id="gh-eyes-item" class="hidden-xs"><a href="https://github.com/marcelluethi/scalismo.github.io"><i class="fa fa-eye"></i><span>WATCH<span id="eyes" class="label label-default">--</span></span></a></li><li id="gh-stars-item" class="hidden-xs"><a href="https://github.com/marcelluethi/scalismo.github.io"><i class="fa fa-star-o"></i><span>STARS<span id="stars" class="label label-default">--</span></span></a></li><li><a href="#" onclick="shareSiteTwitter('scalismo Scalismo - Scalable Image Analysis and Shape Modelling ');"><i class="fa fa-twitter"></i></a></li><li><a href="#" onclick="shareSiteFacebook('scalismo Scalismo - Scalable Image Analysis and Shape Modelling ');"><i class="fa fa-facebook"></i></a></li><li><a href="#" onclick="shareSiteGoogle();"><i class="fa fa-google-plus"></i></a></li></ul></div></div></div></div><div id="content" data-github-owner="marcelluethi" data-github-repo="scalismo.github.io"><div class="content-wrapper"><section><head>

    <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
            tex2jax: {
              inlineMath: [ ['$','$'], ["\\(","\\)"] ],
              processEscapes: true
            }
          });
        </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
</head>

<h1 id="rigid-alignment">Rigid alignment</h1>

<p>In this tutorial we show how rigid alignment of shapes can be performed in Scalismo.</p>

<h5 id="related-resources">Related resources</h5>

<p>The following resources from our <a href="https://www.futurelearn.com/courses/statistical-shape-modelling">online course</a> may provide
some helpful context for this tutorial:</p>

<ul>
  <li>Learning a model from example data <a href="https://www.futurelearn.com/courses/statistical-shape-modelling/3/steps/250329">(Video)</a></li>
  <li>Superimposing shapes <a href="https://www.futurelearn.com/courses/statistical-shape-modelling/3/steps/250330">(Article)</a></li>
</ul>

<h5 id="preparation">Preparation</h5>

<p>As in the previous tutorials, we start by importing some commonly used objects and initializing the system.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scalismo.geometry._</span>
<span class="k">import</span> <span class="nn">scalismo.common._</span>
<span class="k">import</span> <span class="nn">scalismo.ui.api._</span>
<span class="k">import</span> <span class="nn">scalismo.mesh.TriangleMesh</span>
<span class="k">import</span> <span class="nn">scalismo.io.MeshIO</span>

<span class="n">scalismo</span><span class="o">.</span><span class="n">initialize</span><span class="o">()</span>
<span class="k">implicit</span> <span class="k">val</span> <span class="n">rng</span> <span class="k">=</span> <span class="n">scalismo</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="nc">Random</span><span class="o">(</span><span class="mi">42</span><span class="o">)</span>
</code></pre></div></div>

<h3 id="quick-view-on-transformations">Quick view on Transformations</h3>

<p>Let’s start by loading and showing Paola’s mesh again:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">ui</span> <span class="k">=</span> <span class="nc">ScalismoUI</span><span class="o">()</span>
<span class="k">val</span> <span class="n">paolaGroup</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">createGroup</span><span class="o">(</span><span class="s">"paola"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">mesh</span> <span class="k">:</span> <span class="kt">TriangleMesh</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="nc">MeshIO</span><span class="o">.</span><span class="n">readMesh</span><span class="o">(</span><span class="k">new</span> <span class="n">java</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="nc">File</span><span class="o">(</span><span class="s">"datasets/Paola.stl"</span><span class="o">)).</span><span class="n">get</span>
<span class="k">val</span> <span class="n">meshView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaGroup</span><span class="o">,</span> <span class="n">mesh</span><span class="o">,</span> <span class="s">"Paola"</span><span class="o">)</span>
</code></pre></div></div>

<p>Scalismo allows us to perform geometric transformations on meshes.</p>

<p>Transformations are <em>functions</em> that map a given point, into a new <em>transformed</em> point.
We find the transformations in the package <code class="highlighter-rouge">scalismo.registration</code>.
Let’s import the classes in this package</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scalismo.registration.</span><span class="o">{</span><span class="nc">Transformation</span><span class="o">,</span> <span class="nc">RotationTransform</span><span class="o">,</span> <span class="nc">TranslationTransform</span><span class="o">,</span> <span class="nc">RigidTransformation</span><span class="o">}</span>
</code></pre></div></div>

<p>The most general way to define a transformation is by specifying the transformation function
explicitly. The following example illustrates this by defining a transformation,
which flips the point along the x axis.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">flipTransform</span> <span class="k">=</span> <span class="nc">Transformation</span><span class="o">((</span><span class="n">p</span> <span class="k">:</span> <span class="kt">Point</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">])</span> <span class="k">=&gt;</span> <span class="nc">Point</span><span class="o">(-</span><span class="n">p</span><span class="o">.</span><span class="n">x</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span><span class="o">,</span> <span class="n">p</span><span class="o">.</span><span class="n">z</span><span class="o">))</span>
</code></pre></div></div>

<p>When given a point as an argument, the defined transform will then simply return a new point:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">pt</span> <span class="k">:</span> <span class="kt">Point</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="n">flipTransform</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mf">1.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">,</span> <span class="mf">1.0</span><span class="o">))</span>
<span class="c1">// pt: Point[_3D] = Point3D(-1.0, 1.0, 1.0)
</span></code></pre></div></div>

<p>An important class of transformations are the rigid transformation, i.e. a rotation followed by a translation. Due to their
importance, these transformations are readily defined in scalismo.</p>

<p>A translation can be defined by specifying the translation vector, which is
added to every point:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">translation</span> <span class="k">=</span> <span class="nc">TranslationTransform</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">](</span><span class="nc">EuclideanVector</span><span class="o">(</span><span class="mi">100</span><span class="o">,</span><span class="mi">0</span><span class="o">,</span><span class="mi">0</span><span class="o">))</span>
</code></pre></div></div>

<p>For defining a rotation, we define the 3 <a href="https://en.wikipedia.org/wiki/Euler_angles">Euler angles</a> , as well as the center of rotation.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">rotationCenter</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">,</span> <span class="mf">0.0</span><span class="o">)</span>
<span class="k">val</span> <span class="n">rotation</span> <span class="k">:</span> <span class="kt">RotationTransform</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="nc">RotationTransform</span><span class="o">(</span><span class="mf">0f</span><span class="o">,</span><span class="mf">3.14f</span><span class="o">,</span><span class="mf">0f</span><span class="o">,</span> <span class="n">rotationCenter</span><span class="o">)</span>
</code></pre></div></div>

<p>This transformation rotates every point with approximately 180 degrees around the Y axis (centered at the origin of the space).</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">pt2</span> <span class="k">:</span> <span class="kt">Point</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="n">rotation</span><span class="o">(</span><span class="nc">Point</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">,</span><span class="mi">1</span><span class="o">))</span>
<span class="c1">// pt2: Point[_3D] = Point3D(-0.9984061838821647, 1.0, -1.0015912799070552)
</span></code></pre></div></div>

<p>In Scalismo, such transformations can be applied not only to single points, but most collections of points such as triangle meshes, can be
transformed by invoking the method <code class="highlighter-rouge">transform</code> on the respective object.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">translatedPaola</span> <span class="k">:</span> <span class="kt">TriangleMesh</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">translation</span><span class="o">)</span>
<span class="k">val</span> <span class="n">paolaMeshTranslatedView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaGroup</span><span class="o">,</span> <span class="n">translatedPaola</span><span class="o">,</span> <span class="s">"translatedPaola"</span><span class="o">)</span>
</code></pre></div></div>

<h3 id="composing-transformations">Composing transformations</h3>

<p>Simple transformations can be composed to more complicated ones using the <code class="highlighter-rouge">compose</code> method. For example, we can define a rigid
tranformation as a composition of translation and rotation:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">rigidTransform1</span> <span class="k">=</span> <span class="n">translation</span><span class="o">.</span><span class="n">compose</span><span class="o">(</span><span class="n">rotation</span><span class="o">)</span>
</code></pre></div></div>

<p>In Scalismo, rigid transformations are also already predefined. We could have written instead:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">rigidTransform2</span> <span class="k">:</span> <span class="kt">RigidTransformation</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="nc">RigidTransformation</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">](</span><span class="n">translation</span><span class="o">,</span> <span class="n">rotation</span><span class="o">)</span>
</code></pre></div></div>

<p><em>Exercise: Apply the rotation transform to the original mesh of Paola and show the result</em></p>

<p><em>Note: since the rotation is around the origin, you might have to zoom out (hold right click and drag down) to see the result.</em></p>

<h3 id="rigid-alignment-1">Rigid alignment</h3>

<p>A task that we need to perform in any shape modelling pipeline, is the rigid alignment of objects; I.e. normalizing the pose of
an object with respect to some reference.</p>

<p>To illustrate this procedure, we transform the mesh of Paola rigidly using the
rigid transformation defined above.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">paolaTransformedGroup</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">createGroup</span><span class="o">(</span><span class="s">"paolaTransformed"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">paolaTransformed</span> <span class="k">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">rigidTransform2</span><span class="o">)</span>
<span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaTransformedGroup</span><span class="o">,</span> <span class="n">paolaTransformed</span><span class="o">,</span> <span class="s">"paolaTransformed"</span><span class="o">)</span>
</code></pre></div></div>

<p>The task is now to retrieve the transformation, which best aligns the transformed mesh
with the original mesh, from the meshes alone.</p>

<p>Rigid alignment is easiest if we already know some corresponding points in both shapes. Assume for the moment, that we
have identified a few corresponding points and marked them using landmarks. We can then apply <em>Procrustes Analysis</em>.
Usually, these landmarks would need to be clicked manually in a GUI framework. To simplify this tutorial, we exploit that the two meshes
are the same and hence have the same point ids. We can thus define landmarks programmatically:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">ptIds</span> <span class="k">=</span> <span class="nc">Seq</span><span class="o">(</span><span class="nc">PointId</span><span class="o">(</span><span class="mi">2213</span><span class="o">),</span> <span class="nc">PointId</span><span class="o">(</span><span class="mi">14727</span><span class="o">),</span> <span class="nc">PointId</span><span class="o">(</span><span class="mi">8320</span><span class="o">),</span> <span class="nc">PointId</span><span class="o">(</span><span class="mi">48182</span><span class="o">))</span>
<span class="k">val</span> <span class="n">paolaLandmarks</span> <span class="k">=</span> <span class="n">ptIds</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">pId</span> <span class="k">=&gt;</span> <span class="nc">Landmark</span><span class="o">(</span><span class="n">s</span><span class="s">"lm-${pId.id}"</span><span class="o">,</span> <span class="n">mesh</span><span class="o">.</span><span class="n">pointSet</span><span class="o">.</span><span class="n">point</span><span class="o">(</span><span class="n">pId</span><span class="o">)))</span>
<span class="k">val</span> <span class="n">paolaTransformedLandmarks</span> <span class="k">=</span> <span class="n">ptIds</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">pId</span> <span class="k">=&gt;</span> <span class="nc">Landmark</span><span class="o">(</span><span class="n">s</span><span class="s">"lm-${pId.id}"</span><span class="o">,</span> <span class="n">paolaTransformed</span><span class="o">.</span><span class="n">pointSet</span><span class="o">.</span><span class="n">point</span><span class="o">(</span><span class="n">pId</span><span class="o">)))</span>

<span class="k">val</span> <span class="n">paolaLandmarkViews</span> <span class="k">=</span> <span class="n">paolaLandmarks</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">lm</span> <span class="k">=&gt;</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaGroup</span><span class="o">,</span> <span class="n">lm</span><span class="o">,</span> <span class="n">s</span><span class="s">"${lm.id}"</span><span class="o">))</span>
<span class="k">val</span> <span class="n">paolaTransformedLandmarkViews</span> <span class="k">=</span> <span class="n">paolaTransformedLandmarks</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">lm</span> <span class="k">=&gt;</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaTransformedGroup</span><span class="o">,</span> <span class="n">lm</span><span class="o">,</span> <span class="n">lm</span><span class="o">.</span><span class="n">id</span><span class="o">))</span>
</code></pre></div></div>

<p>Given this lists of landmarks, we can use the method <code class="highlighter-rouge">rigid3DLandmarkRegistration</code>
to retrieve the best rigid transformation from the original set of landmarks:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nn">scalismo.registration.LandmarkRegistration</span>

<span class="k">val</span> <span class="n">bestTransform</span> <span class="k">:</span> <span class="kt">RigidTransformation</span><span class="o">[</span><span class="k">_</span><span class="err">3</span><span class="kt">D</span><span class="o">]</span> <span class="k">=</span> <span class="nc">LandmarkRegistration</span><span class="o">.</span><span class="n">rigid3DLandmarkRegistration</span><span class="o">(</span><span class="n">paolaLandmarks</span><span class="o">,</span> <span class="n">paolaTransformedLandmarks</span><span class="o">,</span> <span class="n">center</span> <span class="k">=</span> <span class="nc">Point</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="mi">0</span><span class="o">))</span>
</code></pre></div></div>

<p>The resulting transformation is the best possible rigid transformation (with rotation center <code class="highlighter-rouge">Point(0,0,0)</code>) from <code class="highlighter-rouge">paolaLandmarks</code> to <code class="highlighter-rouge">paolaTransformedLandmarks</code>.
Best here means, that it minimizes the mean squared error over the landmark points.</p>

<p>Let’s now apply it to the original set of landmarks, to see how well they are transformed :</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">transformedLms</span> <span class="k">=</span> <span class="n">paolaLandmarks</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">lm</span> <span class="k">=&gt;</span> <span class="n">lm</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">bestTransform</span><span class="o">))</span>
<span class="k">val</span> <span class="n">landmarkViews</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaGroup</span><span class="o">,</span> <span class="n">transformedLms</span><span class="o">,</span> <span class="s">"transformedLMs"</span><span class="o">)</span>
</code></pre></div></div>

<p>And finally, we apply the transformation to the entire mesh:</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="n">alignedPaola</span> <span class="k">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">transform</span><span class="o">(</span><span class="n">bestTransform</span><span class="o">)</span>
<span class="k">val</span> <span class="n">alignedPaolaView</span> <span class="k">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">show</span><span class="o">(</span><span class="n">paolaGroup</span><span class="o">,</span> <span class="n">alignedPaola</span><span class="o">,</span> <span class="s">"alignedPaola"</span><span class="o">)</span> 
<span class="n">alignedPaolaView</span><span class="o">.</span><span class="n">color</span> <span class="k">=</span> <span class="n">java</span><span class="o">.</span><span class="n">awt</span><span class="o">.</span><span class="nc">Color</span><span class="o">.</span><span class="nc">RED</span>
</code></pre></div></div>

</section></div></div></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script><script src="/scalismo.github.io/highlight/highlight.pack.js"></script><script>hljs.configure({languages:['scala','java','bash']});
hljs.initHighlighting();
              </script><script>((window.gitter = {}).chat = {}).options = {
room: 'marcelluethi/scalismo.github.io'};</script><script src="https://sidecar.gitter.im/dist/sidecar.v1.js"></script><script src="/scalismo.github.io/js/main.js"></script></body></html>